components:
  schemas:
    Candidate:
      type: object
      properties:
        id:
          type: string
          format: uuid
        company_id:
          type: string
          format: uuid
        job_id:
          type: string
          format: uuid
        first_name:
          type: string
        last_name:
          type: string
        email:
          type: string
        phone:
          type: string
        cv_url:
          type: string
        status:
          type: string
          enum: [pending, in_progress, dismissed]
        agg_score:
          type: integer
        applied_at:
          type: string
          format: date-time

/api/v1/candidates:
  post:
    summary: Add a candidate to a job
    tags:
      - CANDIDATES
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [job_id, first_name, last_name, email, phone]
            properties:
              job_id:
                type: string
                format: uuid
                example: a1b2c3d4-e5f6-7890-abcd-ef1234567890
              first_name:
                type: string
                example: John
              last_name:
                type: string
                example: Doe
              email:
                type: string
                example: john.doe@example.com
              phone:
                type: string
                example: "+905551234567"
              cv_url:
                type: string
                example: https://storage.example.com/cv/john-doe.pdf
    responses:
      '201':
        description: Candidate created
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Candidate'
      '400':
        description: Missing required fields
      '401':
        description: Unauthorized
      '409':
        description: Candidate already applied for this job

  get:
    summary: Get all candidates (optionally filter by job)
    tags:
      - CANDIDATES
    security:
      - bearerAuth: []
    parameters:
      - in: query
        name: job_id
        required: false
        schema:
          type: string
          format: uuid
        description: Filter candidates by job
    responses:
      '200':
        description: List of candidates
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/Candidate'
      '401':
        description: Unauthorized

/api/v1/candidates/{id}:
  get:
    summary: Get a candidate by ID
    tags:
      - CANDIDATES
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Candidate found
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Candidate'
      '401':
        description: Unauthorized
      '404':
        description: Candidate not found

  put:
    summary: Update a candidate (status, score)
    tags:
      - CANDIDATES
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              status:
                type: string
                enum: [pending, in_progress, dismissed]
              agg_score:
                type: integer
    responses:
      '200':
        description: Candidate updated
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Candidate'
      '401':
        description: Unauthorized
      '404':
        description: Candidate not found
